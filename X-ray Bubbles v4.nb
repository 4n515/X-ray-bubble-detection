(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     98812,       1878]
NotebookOptionsPosition[     95383,       1801]
NotebookOutlinePosition[     95965,       1822]
CellTagsIndexPosition[     95922,       1819]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Section",
 CellChangeTimes->{{3.7601694528358383`*^9, 3.760169472551669*^9}, {
  3.9705067583367853`*^9, 
  3.9705067589037313`*^9}},ExpressionUUID->"ca134099-a44f-4fdc-af75-\
6ea375b76f8d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HistoryLength", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"$Context", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startTime", " ", "=", " ", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeElapsed", ":=", 
    RowBox[{
     RowBox[{"AbsoluteTime", "[", "]"}], "-", "startTime"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useKernels", "=", 
   RowBox[{"2", "*", "$ProcessorCount"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "@", "monitorCounter"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fontSize", "=", "16"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"Kernels", "[", "]"}]}], "<", "useKernels"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Speak", "@", "\"\<Launching kernels\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LaunchKernels", "[", 
        RowBox[{"useKernels", "-", 
         RowBox[{"Length", "@", 
          RowBox[{"Kernels", "[", "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "output", " ", "directory"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nbd", "=", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"progress", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"TableForm", "@", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<Processing...\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{"ProgressIndicator", "@", 
      RowBox[{"Dynamic", "[", 
       RowBox[{
        RowBox[{"x", "/", "y"}], "//", "N"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ToString", "@", 
       RowBox[{"Round", "@", "x"}]}], "<>", "\"\</\>\"", "<>", 
      RowBox[{"ToString", "@", "y"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ToString", "@", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"100", "*", 
          RowBox[{"x", "/", "y"}]}], "//", "N"}], "]"}]}], "<>", 
      "\"\< %\>\""}]}], "\[IndentingNewLine]", "}"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.7513674979286723`*^9}, {3.7513707604688616`*^9, 3.7513707609725127`*^9}, 
   3.751712760209059*^9, {3.751718054524271*^9, 3.751718059769699*^9}, {
   3.7518135482953935`*^9, 3.7518135725814433`*^9}, {3.7518710407937007`*^9, 
   3.751871052004719*^9}, {3.751871358211807*^9, 3.751871364445162*^9}, {
   3.751879175723353*^9, 3.7518791825590715`*^9}, {3.7519575243057594`*^9, 
   3.751957528260184*^9}, {3.7519581327610455`*^9, 3.7519581412344737`*^9}, {
   3.751958453957793*^9, 3.7519584557566743`*^9}, {3.751968334426799*^9, 
   3.7519683353822217`*^9}, {3.7519700282986717`*^9, 3.75197002848617*^9}, {
   3.7519737833049164`*^9, 3.75197380799761*^9}, {3.7519738973199735`*^9, 
   3.7519738974366484`*^9}, 3.751974453373953*^9, 3.7519744838607883`*^9, {
   3.7519745775281367`*^9, 3.7519745791647434`*^9}, {3.7519863856792855`*^9, 
   3.751986410580202*^9}, {3.751987189723457*^9, 3.7519872067171807`*^9}, {
   3.7519872740525713`*^9, 3.751987274251018*^9}, 3.7519887579797745`*^9, {
   3.7519888044417067`*^9, 3.7519888045384264`*^9}, {3.7519889388743944`*^9, 
   3.751988953257942*^9}, {3.75198898540973*^9, 3.7519889857218943`*^9}, {
   3.7519891583567*^9, 3.751989168418381*^9}, {3.751989242284319*^9, 
   3.7519892558884606`*^9}, {3.7519893723305483`*^9, 3.751989372402337*^9}, {
   3.7519931269744205`*^9, 3.7519931279248924`*^9}, {3.751993166925639*^9, 
   3.7519931670293694`*^9}, 3.75199861425095*^9, {3.7519986697422304`*^9, 
   3.7519986922896194`*^9}, {3.751999213796385*^9, 3.7519992351032796`*^9}, {
   3.7519994435814323`*^9, 3.7519994603814545`*^9}, {3.7519996162634587`*^9, 
   3.7519996233658457`*^9}, {3.7519999333676405`*^9, 
   3.7519999359958153`*^9}, {3.7520002180623083`*^9, 
   3.7520002187803435`*^9}, {3.7520002493768325`*^9, 
   3.7520002505482464`*^9}, {3.752000407725655*^9, 3.752000411067837*^9}, {
   3.7520004699823575`*^9, 3.75200047026727*^9}, {3.7520022702769604`*^9, 
   3.7520022747149506`*^9}, {3.7520046929402857`*^9, 
   3.7520046960967264`*^9}, {3.7520502955602303`*^9, 
   3.7520503446601734`*^9}, {3.7520514690035224`*^9, 
   3.7520514690514917`*^9}, {3.7520515670681887`*^9, 
   3.7520515977009263`*^9}, {3.7520517074841633`*^9, 
   3.7520517090997686`*^9}, {3.7520518266893578`*^9, 
   3.7520518310232763`*^9}, {3.7520519932426023`*^9, 
   3.7520519966515093`*^9}, {3.752211767119261*^9, 3.7522117933048677`*^9}, 
   3.7522118378507395`*^9, {3.7522119014341974`*^9, 3.7522119154280024`*^9}, {
   3.752211947983062*^9, 3.7522119754180403`*^9}, {3.75238986004722*^9, 
   3.7523898600877047`*^9}, 3.759935401921358*^9, {3.7600950420507*^9, 
   3.7600950507155514`*^9}, 3.76009546165426*^9, {3.760097847762862*^9, 
   3.7600978479823008`*^9}, {3.7601571295604706`*^9, 3.760157129648235*^9}, 
   3.7601592766146355`*^9, {3.7601729472799244`*^9, 3.760172947511306*^9}, {
   3.7601732107197742`*^9, 3.760173211161602*^9}, 3.760175621125779*^9, 
   3.7602497894762554`*^9, 3.7602549941536517`*^9, 3.7602587711196823`*^9, {
   3.760269954882045*^9, 3.760269955256042*^9}, {3.7602794081805344`*^9, 
   3.760279410170213*^9}, {3.7602794702182603`*^9, 3.7602794767148857`*^9}, {
   3.7603410399150243`*^9, 3.760341041124792*^9}, {3.7604556788470125`*^9, 
   3.760455727922307*^9}, {3.7607682966617975`*^9, 3.760768308975419*^9}, 
   3.7607854536095047`*^9, {3.7608865838057194`*^9, 3.760886593361717*^9}, {
   3.7608866844010015`*^9, 3.7608866845675573`*^9}, {3.760887388038473*^9, 
   3.7608873882957788`*^9}, {3.760892595971661*^9, 3.7608926320929804`*^9}, {
   3.760929281108795*^9, 3.7609292932042255`*^9}, {3.7609293967314425`*^9, 
   3.7609294116522813`*^9}, {3.7609299152508698`*^9, 
   3.7609299156738005`*^9}, {3.760929954547063*^9, 3.7609300117870555`*^9}, {
   3.7609305684759817`*^9, 3.7609305685647535`*^9}, {3.7609314858821344`*^9, 
   3.7609314866510773`*^9}, {3.76093194642652*^9, 3.7609320560911016`*^9}, {
   3.7609321259960537`*^9, 3.760932174706381*^9}, {3.760932243970749*^9, 
   3.7609322520343113`*^9}, {3.7609322828032403`*^9, 
   3.7609322830575356`*^9}, {3.7609323214867444`*^9, 3.760932328043228*^9}, {
   3.7609324262318645`*^9, 3.760932446891398*^9}, {3.7609325111705904`*^9, 
   3.7609325119006367`*^9}, {3.760932875991317*^9, 3.760932877280859*^9}, 
   3.7609344640420094`*^9, {3.7609346032407713`*^9, 3.7609346068281736`*^9}, 
   3.7609433236004734`*^9, {3.760956474733452*^9, 3.760956588831177*^9}, {
   3.760957423846837*^9, 3.760957424285645*^9}, {3.7609580829565725`*^9, 
   3.760958083252755*^9}, {3.7609624911993523`*^9, 3.760962491368901*^9}, 
   3.760964457907423*^9, {3.7609646733113832`*^9, 3.7609646739666595`*^9}, {
   3.7612251729077897`*^9, 3.761225175298395*^9}, 3.761228707061983*^9, {
   3.761228758894994*^9, 3.7612287693206973`*^9}, 3.76122887626292*^9, {
   3.761241692049399*^9, 3.761241700577155*^9}, {3.761276326824277*^9, 
   3.7612763974426746`*^9}, {3.761276432872349*^9, 3.7612764775169487`*^9}, {
   3.7612946605842495`*^9, 3.761294670639862*^9}, {3.761299408431904*^9, 
   3.761299408500719*^9}, {3.7612996367268124`*^9, 3.7612996374924726`*^9}, {
   3.761300049404646*^9, 3.7613000513349247`*^9}, 3.7613041176850076`*^9, {
   3.7613180259074817`*^9, 3.7613180299262967`*^9}, {3.761326801495341*^9, 
   3.761326801590087*^9}, {3.761361249393982*^9, 3.7613612743078856`*^9}, 
   3.761361637701935*^9, 3.7613688777915*^9, {3.7613702345313025`*^9, 
   3.761370234824539*^9}, 3.7613711538469987`*^9, {3.7613717056648607`*^9, 
   3.761371739016631*^9}, {3.7613737377183404`*^9, 3.761373764221431*^9}, {
   3.7613739329982166`*^9, 3.7613739347046556`*^9}, {3.76138015596413*^9, 
   3.7613801562354217`*^9}, 3.7613846372534046`*^9, 3.7613861252512884`*^9, {
   3.761386510741501*^9, 3.761386512992342*^9}, {3.76138735930517*^9, 
   3.7613873604308023`*^9}, 3.7613919238287992`*^9, {3.7613966008619995`*^9, 
   3.761396602922511*^9}, {3.761397681510357*^9, 3.7613977017222805`*^9}, {
   3.761397741281606*^9, 3.7613977420625305`*^9}, 3.761458322673535*^9, {
   3.7614808507366533`*^9, 3.761480850863311*^9}, {3.761481217958542*^9, 
   3.761481218006412*^9}, {3.761481391522843*^9, 3.7614813917023582`*^9}, {
   3.7616463961540794`*^9, 3.7616463965540085`*^9}, {3.7616466354593477`*^9, 
   3.7616466372246256`*^9}, 3.7616469120822287`*^9, {3.7616469825807066`*^9, 
   3.7616469828070736`*^9}, 3.7616471557855463`*^9, {3.7616474401845856`*^9, 
   3.7616474403651204`*^9}, {3.7669408858877015`*^9, 
   3.7669409039843745`*^9}, {3.766941304508911*^9, 3.766941317480905*^9}, {
   3.7669421675895166`*^9, 3.7669421679592876`*^9}, {3.7669422723714056`*^9, 
   3.7669422852215776`*^9}, 3.7693096869252996`*^9, {3.7693121239866257`*^9, 
   3.769312124973962*^9}, {3.770495826828769*^9, 3.7704958272831993`*^9}, {
   3.770496682805866*^9, 3.7704966853412914`*^9}, 3.7704972485030303`*^9, {
   3.772348615909038*^9, 3.7723486259132843`*^9}, {3.7723569128808775`*^9, 
   3.7723569371043353`*^9}, 3.772357142969572*^9, {3.773302667131933*^9, 
   3.7733026751664457`*^9}, 3.7733110313379755`*^9, {3.773313780313419*^9, 
   3.7733138221432843`*^9}, {3.773314248470578*^9, 3.7733142486251464`*^9}, {
   3.7733142787356873`*^9, 3.773314292375209*^9}, 3.77331446898584*^9, 
   3.7733158643634233`*^9, 3.773384309726469*^9, {3.7733843768285084`*^9, 
   3.773384377838806*^9}, {3.7733844281663017`*^9, 3.773384449669899*^9}, {
   3.773385380102294*^9, 3.7733853802798233`*^9}, {3.773385937875291*^9, 
   3.773385938044855*^9}, {3.7733861080067606`*^9, 3.7733861091726418`*^9}, {
   3.777997349884369*^9, 3.7779973563449507`*^9}, {3.7779996736864486`*^9, 
   3.7779996945889626`*^9}, {3.778000628153318*^9, 3.77800062846565*^9}, {
   3.778910686621645*^9, 3.778910697341301*^9}, 3.778912337336089*^9, 
   3.7789123768874874`*^9, {3.7789159986463156`*^9, 3.7789160026207256`*^9}, {
   3.7809872939257684`*^9, 3.7809873006298585`*^9}, {3.780987475485282*^9, 
   3.78098747556008*^9}, {3.7809896040832243`*^9, 3.780989604150044*^9}, {
   3.781935631264923*^9, 3.7819357387741823`*^9}, {3.781935786817588*^9, 
   3.781935789483755*^9}, {3.781935822050601*^9, 3.781935844021475*^9}, 
   3.781935952957399*^9, {3.7819360298904686`*^9, 3.781936152963578*^9}, {
   3.781936269545663*^9, 3.781936273291142*^9}, {3.7819363239942007`*^9, 
   3.7819363715786777`*^9}, {3.7819364243604083`*^9, 3.781936490311517*^9}, {
   3.7819365596095605`*^9, 3.781936596070054*^9}, {3.7819366925687356`*^9, 
   3.7819366957739286`*^9}, {3.7819368052746944`*^9, 3.781936807140668*^9}, {
   3.781936859476156*^9, 3.781936863401528*^9}, {3.7819416869917955`*^9, 
   3.7819417112924576`*^9}, {3.782543730338276*^9, 3.7825437436547947`*^9}, {
   3.7825445288316917`*^9, 3.7825445413330674`*^9}, {3.782549525253271*^9, 
   3.7825495759256086`*^9}, 3.782550829225337*^9, 3.7825510657753696`*^9, {
   3.7825610200080705`*^9, 3.782561029255045*^9}, {3.782561330183058*^9, 
   3.7825613307435355`*^9}, {3.7825621095052013`*^9, 
   3.7825621437652845`*^9}, {3.782562204700952*^9, 3.782562240849332*^9}, {
   3.7825623277982025`*^9, 3.782562329644215*^9}, {3.782562394600174*^9, 
   3.7825623991765485`*^9}, {3.782562555569565*^9, 3.782562586701932*^9}, {
   3.782811721951993*^9, 3.78281173300521*^9}, {3.782811806833519*^9, 
   3.7828118474077225`*^9}, {3.7828118863261986`*^9, 3.782811886544095*^9}, {
   3.78281216649263*^9, 3.7828121743060193`*^9}, {3.782812285957327*^9, 
   3.782812310254076*^9}, {3.782905628363512*^9, 3.7829056766168594`*^9}, {
   3.7829057346254635`*^9, 3.782905736966573*^9}, {3.7829541779702463`*^9, 
   3.782954178967338*^9}, {3.78295495311665*^9, 3.782954960798777*^9}, 
   3.783318420161974*^9, {3.783318592271903*^9, 3.7833185995539093`*^9}, {
   3.7833186779453497`*^9, 3.783318678257719*^9}, {3.7833392025862613`*^9, 
   3.7833392047583385`*^9}, {3.783339263051766*^9, 3.7833392655205774`*^9}, {
   3.7836865941072903`*^9, 3.7836866002947683`*^9}, {3.783686712826186*^9, 
   3.7836867178144765`*^9}, {3.7836867657394342`*^9, 3.7836867657785387`*^9}, 
   3.783687283264184*^9, {3.7836874026207447`*^9, 3.7836874027049575`*^9}, {
   3.783687604715908*^9, 3.783687606035407*^9}, {3.783690156587172*^9, 
   3.783690156887972*^9}, {3.783775559742628*^9, 3.783775565458743*^9}, 
   3.7838403790244675`*^9, {3.783840817865399*^9, 3.7838408183406677`*^9}, {
   3.7838409041394987`*^9, 3.7838409079737425`*^9}, {3.783840999613789*^9, 
   3.783841000758848*^9}, {3.7838411538186135`*^9, 3.783841169385147*^9}, {
   3.783841260332086*^9, 3.7838412603942523`*^9}, {3.783841443005767*^9, 
   3.7838414437407427`*^9}, 3.7839189602328396`*^9, {3.783918993528123*^9, 
   3.7839189935776834`*^9}, {3.783921394659896*^9, 3.783921395575432*^9}, {
   3.7839217286527004`*^9, 3.783921735277869*^9}, {3.7839314390562525`*^9, 
   3.7839314415103645`*^9}, {3.7839354079410405`*^9, 3.78393548147972*^9}, 
   3.7842903496261168`*^9, 3.784292608699628*^9, {3.784292658412279*^9, 
   3.784292662423986*^9}, {3.784292828983741*^9, 3.7842928320539427`*^9}, {
   3.784298737150395*^9, 3.7842987508490076`*^9}, {3.7843036626957164`*^9, 
   3.784303662775931*^9}, 3.7843272589156914`*^9, {3.7843275909060335`*^9, 
   3.7843275912402177`*^9}, {3.7843591557525606`*^9, 
   3.7843591557659545`*^9}, {3.784386027858904*^9, 3.784386031639289*^9}, {
   3.7843919626786337`*^9, 3.7843919627282486`*^9}, 3.784403184161606*^9, 
   3.7844071042245655`*^9, {3.842588872792037*^9, 3.8425888978411617`*^9}, {
   3.843875638052524*^9, 3.843875661849861*^9}, 3.844507229481266*^9, {
   3.845035801008132*^9, 3.845035805843377*^9}, {3.8450382118847113`*^9, 
   3.84503821515665*^9}, {3.84503842497435*^9, 3.845038446050909*^9}, {
   3.845084210927106*^9, 3.84508421117356*^9}, {3.845112687313458*^9, 
   3.84511268755442*^9}, {3.845114719936674*^9, 3.845114720002236*^9}, {
   3.845115702138193*^9, 3.8451157022150993`*^9}, {3.845116687638585*^9, 
   3.845116687721293*^9}, {3.845118985972445*^9, 3.845118986056671*^9}, {
   3.845120808246766*^9, 3.845120812006054*^9}, {3.845787898673205*^9, 
   3.84578790103152*^9}, {3.845791710200428*^9, 3.8457917209660673`*^9}, {
   3.8502989742301683`*^9, 3.850298974618709*^9}, {3.851146621360949*^9, 
   3.85114663188135*^9}, {3.851165396420528*^9, 3.851165397574546*^9}, {
   3.851165522448071*^9, 3.851165527132092*^9}, {3.851167839090938*^9, 
   3.851167839528161*^9}, {3.85116807302209*^9, 3.851168096360923*^9}, {
   3.85125684849809*^9, 3.851256849315588*^9}, {3.851257136983713*^9, 
   3.851257137393353*^9}, 3.851416788917988*^9, {3.851436177429657*^9, 
   3.851436190092196*^9}, {3.851491656249277*^9, 3.851491676529953*^9}, {
   3.851494345875263*^9, 3.851494367757698*^9}, {3.8552554216858377`*^9, 
   3.855255431453865*^9}, {3.855382004875628*^9, 3.8553820365855618`*^9}, {
   3.855391256596958*^9, 3.855391264209152*^9}, {3.855391303552845*^9, 
   3.85539130413202*^9}, {3.8557293033159647`*^9, 3.855729317759015*^9}, {
   3.855729377956114*^9, 3.855729397602292*^9}, {3.855729502706747*^9, 
   3.855729505315651*^9}, {3.855729692733131*^9, 3.855729711371088*^9}, {
   3.85572975637493*^9, 3.85572977753918*^9}, {3.855729837498407*^9, 
   3.8557298481118*^9}, {3.856249390847074*^9, 3.856249437039401*^9}, {
   3.856249486786076*^9, 3.85624960495793*^9}, {3.8562499255168123`*^9, 
   3.856249944509707*^9}, {3.856252289743327*^9, 3.8562522927056837`*^9}, {
   3.856254748817528*^9, 3.856254782830542*^9}, {3.856255285725709*^9, 
   3.856255289154048*^9}, {3.856268313370656*^9, 3.8562683435110283`*^9}, {
   3.8562683919993057`*^9, 3.8562684053174667`*^9}, {3.859021672351989*^9, 
   3.859021681643783*^9}, {3.859451425847169*^9, 3.8594514351375723`*^9}, {
   3.860045958434455*^9, 3.860045960493469*^9}, {3.860045995381274*^9, 
   3.860045996580369*^9}, {3.8600498451758375`*^9, 3.860049855711029*^9}, 
   3.8600498986090145`*^9, {3.860049950356762*^9, 3.860049954671027*^9}, {
   3.8600588117248917`*^9, 3.860058834112878*^9}, 3.860059040764468*^9, {
   3.8600596120856943`*^9, 3.860059619659663*^9}, {3.860060030197404*^9, 
   3.860060035079748*^9}, {3.860078517566392*^9, 3.86007853473974*^9}, {
   3.860741813770084*^9, 3.860741817282125*^9}, 3.8607418602949266`*^9, 
   3.860744350617853*^9, {3.8622410041123123`*^9, 3.862241023256938*^9}, {
   3.86291444972351*^9, 3.862914450674755*^9}, {3.8629470509037037`*^9, 
   3.86294709339123*^9}, {3.8629471851051483`*^9, 3.862947192455482*^9}, {
   3.869297713287373*^9, 3.869297747266222*^9}, {3.869299098431284*^9, 
   3.869299121042487*^9}, {3.870787019030633*^9, 3.870787023390145*^9}, {
   3.870787639402027*^9, 3.87078771812568*^9}, 3.870788136571521*^9, {
   3.8707884184591722`*^9, 3.8707884289094954`*^9}, {3.8707887903006134`*^9, 
   3.8707888076595945`*^9}, 3.870790224219264*^9, {3.9566754948430977`*^9, 
   3.9566755001689687`*^9}, {3.9566756862678413`*^9, 
   3.9566756901455173`*^9}, {3.95667578253808*^9, 3.956675808059477*^9}, 
   3.970504746836873*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"5bdd9b41-adda-49f7-8ac7-e53702cea021"]
}, Closed]],

Cell[CellGroupData[{

Cell["Filter Function Definitions", "Section",
 CellChangeTimes->{{3.751808845615265*^9, 3.75180886393727*^9}, {
  3.751808901177807*^9, 3.7518089106497416`*^9}, {3.8426073866211615`*^9, 
  3.8426073883328094`*^9}, {3.842607419564908*^9, 3.8426074208915234`*^9}, {
  3.85539217810675*^9, 3.8553922322676373`*^9}, {3.869297787524592*^9, 
  3.8692977951037283`*^9}, {3.8707878323074036`*^9, 3.870787836635366*^9}, {
  3.9705067544485598`*^9, 
  3.970506755172696*^9}},ExpressionUUID->"46134b1a-e07e-4140-b2c8-\
d07a1cf56718"],

Cell[CellGroupData[{

Cell["Segment Measurements", "Subsection",
 CellChangeTimes->{{3.8553922564755487`*^9, 3.855392274521996*^9}, {
   3.9566764901609764`*^9, 3.956676494690978*^9}, 
   3.9705067641615553`*^9},ExpressionUUID->"d15ccfb4-8b6a-43d3-86cb-\
1fa3f92c1214"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getSegmentData", "[", "image_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ComponentMeasurements", "[", 
      RowBox[{"image", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Image\>\"", ",", "\"\<FilledCount\>\"", ",", "\"\<Centroid\>\"", 
         ",", "\"\<SemiAxes\>\"", ",", "\"\<BoundingBox\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#FilledCount", ">", "minimumComponentSize"}], "&"}]}], 
      "\[IndentingNewLine]", "]"}], "/.", 
     RowBox[{"Rule", "\[Rule]", "List"}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8426065570436583`*^9, 3.8426066665406322`*^9}, {
   3.842607007516513*^9, 3.842607055476473*^9}, {3.842607109158572*^9, 
   3.8426071354205365`*^9}, 3.8438779972923813`*^9, {3.8441620862155457`*^9, 
   3.844162102320812*^9}, {3.844162168697233*^9, 3.844162182347393*^9}, 
   3.8441625552347507`*^9, {3.844164251039551*^9, 3.844164256863307*^9}, 
   3.851166226451797*^9, {3.851411532709231*^9, 3.851411537913583*^9}, {
   3.851411571809169*^9, 3.851411610630981*^9}, {3.869297770482448*^9, 
   3.869297774196671*^9}, 3.9566755910190873`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"879259f2-7656-480a-bdb2-94d48148443e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Local Filter", "Subsection",
 CellChangeTimes->{{3.855392266253675*^9, 3.855392268362562*^9}, {
   3.855729987429985*^9, 3.855729993631806*^9}, 
   3.970506762905631*^9},ExpressionUUID->"72cb9da9-d861-4931-a3ab-\
66302b11f2d7"],

Cell[CellGroupData[{

Cell["Interrogation Window Generator", "Subsubsection",
 CellChangeTimes->{{3.855730002832407*^9, 3.855730015378971*^9}, {
  3.86929785068484*^9, 3.86929785622878*^9}, {3.8707877271152325`*^9, 
  3.8707877362206793`*^9}, {3.97050676584239*^9, 
  3.9705067671767*^9}},ExpressionUUID->"0b6d20cc-4936-4e26-a83e-03e3b772a459"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xPad", "[", "box_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"box", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
       RowBox[{"box", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"scaleSide", "-", "1"}], ")"}], "/", "2"}]}], ")"}], "//", 
   "Round"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yPad", "[", "box_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"scaleSide", "-", "1"}], ")"}], "/", "2"}]}], ")"}], "//", 
    "Round"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boxCenter", "[", "box_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
        RowBox[{"box", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], 
    "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Logic", " ", "to", " ", "avoid", " ", "boxes", " ", "out", " ", "of", " ",
     "image", " ", "bounds"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newBox", "[", "box_", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
           RowBox[{"xPad", "[", "box", "]"}]}], ")"}], "<", "0"}], " ", ",", 
        "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
         RowBox[{"xPad", "[", "box", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"yPad", "[", "box", "]"}]}], ")"}], "<", "0"}], " ", ",", 
        "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
         RowBox[{"yPad", "[", "box", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
           RowBox[{"xPad", "[", "box", "]"}]}], ")"}], ">", "widthPixels"}], 
        ",", "\[IndentingNewLine]", "widthPixels", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
         RowBox[{"xPad", "[", "box", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"box", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"yPad", "[", "box", "]"}]}], ")"}], ">", "heightPixels"}], 
        ",", "\[IndentingNewLine]", "heightPixels", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"box", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"yPad", "[", "box", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8444756687969522`*^9, 3.844475673756844*^9}, {
   3.844508040436142*^9, 3.844508043415061*^9}, {3.844508094184463*^9, 
   3.844508121101644*^9}, {3.844508590752921*^9, 3.844508606101742*^9}, {
   3.844509060452243*^9, 3.844509066315613*^9}, {3.844509535653557*^9, 
   3.844509569011448*^9}, {3.8445096045397043`*^9, 3.844509627349168*^9}, {
   3.84450980662374*^9, 3.844509837721684*^9}, {3.844511345260723*^9, 
   3.8445113577695637`*^9}, {3.8447766046522293`*^9, 3.8447766145757513`*^9}, 
   3.845018863747046*^9, {3.845790508774413*^9, 3.84579051056236*^9}, 
   3.845791812943026*^9, {3.8491666552353888`*^9, 3.849166656803797*^9}, {
   3.851257440494066*^9, 3.851257442080125*^9}, 3.851411072079576*^9, 
   3.862288467819206*^9, {3.862291830857634*^9, 3.862291831892325*^9}, {
   3.8629298233911123`*^9, 3.86292982516271*^9}, {3.8692978582547483`*^9, 
   3.869297922812454*^9}, {3.869299153041678*^9, 3.869299174629799*^9}, {
   3.8707877571728587`*^9, 3.870787775621525*^9}, {3.956675609051277*^9, 
   3.956675611081736*^9}, {3.9708033152184143`*^9, 3.9708034034629297`*^9}, 
   3.970818544888856*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"d1095e33-3a62-4236-a71c-cd273ada1ac0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Local Filter Sequence", "Subsubsection",
 CellChangeTimes->{{3.855730039094634*^9, 3.855730048629545*^9}, 
   3.855730119511755*^9, 3.87078781439604*^9, {3.970506769022914*^9, 
   3.970506771598215*^9}},ExpressionUUID->"200b3a4a-a577-4c86-bee7-\
2edccbb6b300"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"repairResolvedSegment", "[", 
    RowBox[{"img_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Closing", "[", 
     RowBox[{"img", ",", 
      RowBox[{"DiskMatrix", "@", "scale"}]}], "]"}], "//", 
    "FillingTransform"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localFilter", "[", "image_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nonLocalFilteredImage", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NonlocalMeansFilter", "[", 
         RowBox[{
         "#", ",", "\[IndentingNewLine]", "nonlocalMeansFilteringRadius", ",",
           "\[IndentingNewLine]", "nonlocalMeansSearchRadius"}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", "image"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"localAdaptiveBinarizedImage", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"LocalAdaptiveBinarize", "[", "\[IndentingNewLine]", 
         RowBox[{
         "#", ",", "localAdaptiveRadius", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "localAdaptiveMeanFactor", ",", "localAdaptiveDeviationFactor", 
            ",", "localAdaptiveOffset"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], "&"}], "@", "nonLocalFilteredImage"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"tuned", " ", "to", " ", "be", " ", "conservative"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"localAdaptiveBinarizedImageFilled", "=", 
      RowBox[{"FillingTransform", "@", 
       RowBox[{
       "DeleteBorderComponents", "@", "localAdaptiveBinarizedImage"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"localAdaptiveBinarizedImageClean", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Opening", "[", 
             RowBox[{"#", ",", 
              RowBox[{"DiskMatrix", "@", "resolveOpeningScale"}]}], "]"}], 
            "&"}], "@", "\[IndentingNewLine]", 
           RowBox[{"Erosion", "[", 
            RowBox[{"#", ",", 
             RowBox[{"DiskMatrix", "@", "resolveErosionScale"}]}], "]"}]}], 
          "&"}], "@", " ", "\[IndentingNewLine]", 
         RowBox[{"DeleteSmallComponents", "[", 
          RowBox[{"#", ",", "minimumComponentSize"}], "]"}]}], "&"}], "@", 
       "localAdaptiveBinarizedImageFilled"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"gradientImage", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"GradientFilter", "[", 
         RowBox[{"#", ",", "gradientFilterRadius"}], "]"}], "&"}], "@", 
       "nonLocalFilteredImage"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"can", " ", "still", " ", "tuned"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"gradientImageLAbinarized", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"LocalAdaptiveBinarize", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", "localBinRadius", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0.00001"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "@", "gradientImage"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"localSegmentsCombinedFilled", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteBorderComponents", "@", "\[IndentingNewLine]", 
         RowBox[{"Opening", "[", 
          RowBox[{"#", ",", 
           RowBox[{"DiskMatrix", "@", "addFillOpeningScale"}]}], "]"}]}], 
        "&"}], "@", "\[IndentingNewLine]", 
       RowBox[{"FillingTransform", "@", 
        RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
         RowBox[{
         "gradientImageLAbinarized", ",", "\[IndentingNewLine]", 
          "localAdaptiveBinarizedImageClean"}], "\[IndentingNewLine]", 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"resolvedBubbleSegment", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteSmallComponents", "[", 
         RowBox[{"#", ",", "minimumComponentSize"}], "]"}], "&"}], "@", 
       "localSegmentsCombinedFilled"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"repairedBubbleSegment", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Binarize", "/@", 
           RowBox[{"repairResolvedSegment", "[", 
            RowBox[{"#", ",", "repairScale"}], "]"}]}], "&"}], "/@", 
         RowBox[{"Image", "/@", 
          RowBox[{"Last", "/@", 
           RowBox[{"Last", "/@", 
            RowBox[{"ComponentMeasurements", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "\"\<Mask\>\"", "}"}]}], "]"}]}]}]}]}], "&"}], "@",
        "resolvedBubbleSegment"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"recombinedRepairedSegment", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"repairedBubbleSegment", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        "resolvedBubbleSegment", ",", "\[IndentingNewLine]", 
        RowBox[{"ImageAdd", "[", "repairedBubbleSegment", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"localSegmentEnvelope", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Binarize", "[", 
         RowBox[{"#", ",", "globalThresholdAggregated"}], "]"}], "&"}], "@", 
       "nonLocalFilteredImage"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"finalOutputSegment", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteSmallComponents", "[", 
         RowBox[{"#", ",", "localMinSize"}], "]"}], "&"}], "@", 
       RowBox[{"Binarize", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"localSegmentEnvelope", "-", 
          RowBox[{"ColorNegate", "@", "recombinedRepairedSegment"}]}], ",", 
         "0.999"}], "\[IndentingNewLine]", "]"}]}]}]}]}], 
   RowBox[{"(*", 
    RowBox[{"wtf", ",", " ", 
     RowBox[{
     "also", " ", "need", " ", "another", " ", "area", " ", "filter"}]}], 
    "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.849165468231838*^9, 3.84916547208801*^9}, {
   3.849165516340804*^9, 3.849165529890294*^9}, {3.849165626423729*^9, 
   3.849165674073311*^9}, {3.849165730700326*^9, 3.8491657420514307`*^9}, {
   3.849165778244113*^9, 3.849165788550479*^9}, {3.849165818812743*^9, 
   3.84916583006354*^9}, {3.849166085384906*^9, 3.8491661126193438`*^9}, {
   3.8491663249035673`*^9, 3.849166336479144*^9}, {3.8508086530682993`*^9, 
   3.8508086746566*^9}, {3.850808758174551*^9, 3.8508087754423723`*^9}, {
   3.850808865123225*^9, 3.8508088652622766`*^9}, 3.850810750193274*^9, 
   3.850810873080394*^9, 3.850811227662965*^9, {3.8508112648564672`*^9, 
   3.850811272755131*^9}, {3.850811395124139*^9, 3.850811395193986*^9}, {
   3.8508962963501263`*^9, 3.850896314870048*^9}, 3.850896439558076*^9, {
   3.85089839639988*^9, 3.85089842765831*^9}, {3.850898490680416*^9, 
   3.850898491774251*^9}, {3.850898798168311*^9, 3.8508987982317657`*^9}, {
   3.8508998734109697`*^9, 3.850899952612303*^9}, {3.851070586555759*^9, 
   3.851070591993224*^9}, {3.851070743980932*^9, 3.851070785762224*^9}, {
   3.8510708271497717`*^9, 3.851070843831998*^9}, {3.8511604654602613`*^9, 
   3.851160471518746*^9}, {3.8511605363230133`*^9, 3.851160561923091*^9}, {
   3.851160638621375*^9, 3.851160713213951*^9}, {3.851160773073618*^9, 
   3.8511607764362383`*^9}, {3.851160879304347*^9, 3.851160894446467*^9}, {
   3.851160946411192*^9, 3.851160950812594*^9}, {3.85116099149681*^9, 
   3.851160992706768*^9}, {3.851161284374817*^9, 3.8511612881158113`*^9}, {
   3.851161375238935*^9, 3.8511613832419033`*^9}, {3.851161502018971*^9, 
   3.851161506026701*^9}, {3.851162632882958*^9, 3.851162650444531*^9}, {
   3.851162898951083*^9, 3.851162899793001*^9}, {3.851165916643284*^9, 
   3.8511659288077517`*^9}, {3.851411001577317*^9, 3.851411002735545*^9}, {
   3.851411106248914*^9, 3.851411106659194*^9}, {3.851411149766631*^9, 
   3.851411203890164*^9}, {3.851411490338826*^9, 3.8514114923673267`*^9}, {
   3.851420215284925*^9, 3.851420287646965*^9}, {3.855392329350402*^9, 
   3.855392351954213*^9}, {3.8600479937044764`*^9, 3.860048000269642*^9}, {
   3.860048096423245*^9, 3.860048097527088*^9}, {3.8600484270621967`*^9, 
   3.8600484292707977`*^9}, {3.860058888626412*^9, 3.8600589171576653`*^9}, 
   3.862240963187581*^9, {3.862250327035775*^9, 3.862250332573162*^9}, {
   3.862290490889947*^9, 3.862290506359131*^9}, {3.8622934681701393`*^9, 
   3.8622934682535353`*^9}, 3.862293933904554*^9, 3.8622940334277353`*^9, {
   3.8622952046242847`*^9, 3.862295207118287*^9}, 3.8622952768234577`*^9, {
   3.862295371426626*^9, 3.862295374647915*^9}, {3.862296918574012*^9, 
   3.862296918713704*^9}, {3.86229718839336*^9, 3.862297204209866*^9}, 
   3.862297326439307*^9, {3.862297363810978*^9, 3.8622973693614063`*^9}, {
   3.862298154409315*^9, 3.862298162713524*^9}, {3.862298287420413*^9, 
   3.8622982880367126`*^9}, {3.862298937927034*^9, 3.8622989380882807`*^9}, 
   3.86229904304469*^9, {3.862299099465261*^9, 3.862299114870165*^9}, {
   3.8622991466212883`*^9, 3.862299158693223*^9}, {3.8622992742481318`*^9, 
   3.862299300331071*^9}, 3.8629321563676853`*^9, {3.8629329176272593`*^9, 
   3.862933004215103*^9}, {3.862933131384767*^9, 3.862933133515559*^9}, {
   3.862933607666532*^9, 3.8629338177623987`*^9}, 3.862935483217122*^9, {
   3.862935941639187*^9, 3.8629360083573236`*^9}, {3.862936113216325*^9, 
   3.862936138472087*^9}, {3.8629362907935257`*^9, 3.8629363215915203`*^9}, {
   3.862936502231299*^9, 3.862936512220972*^9}, {3.86293674807047*^9, 
   3.8629367968624697`*^9}, {3.862937898740398*^9, 3.862937912386444*^9}, {
   3.862938000323145*^9, 3.862938014470604*^9}, 3.8629381679325047`*^9, {
   3.862938206799197*^9, 3.8629382071805887`*^9}, {3.86293828951814*^9, 
   3.862938359331738*^9}, 3.8629969636382513`*^9, {3.869299235191389*^9, 
   3.86929924090233*^9}, {3.8707877858492746`*^9, 3.870787803284393*^9}, {
   3.8707879583021555`*^9, 3.870787994571618*^9}, {3.870788454659085*^9, 
   3.8707884896113977`*^9}, {3.95667633234033*^9, 3.9566763619060326`*^9}, 
   3.970507515128684*^9, {3.9708034514226027`*^9, 3.9708034543439198`*^9}, {
   3.970803504509712*^9, 3.970803504519972*^9}, {3.970803576087306*^9, 
   3.9708035784777393`*^9}, {3.9708036312459755`*^9, 
   3.9708036677217636`*^9}, {3.9708037018904896`*^9, 
   3.9708037024373875`*^9}, {3.970803774263337*^9, 3.970803796502713*^9}, {
   3.970803835402879*^9, 3.970803882428396*^9}, {3.970803985691557*^9, 
   3.9708039859259415`*^9}, {3.9708040214076347`*^9, 3.970804029924188*^9}, {
   3.9708040727952757`*^9, 3.970804072888939*^9}, {3.9708041759560785`*^9, 
   3.9708041760966597`*^9}, {3.9708042237682257`*^9, 3.9708042438133307`*^9}, 
   3.9708048957890863`*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"67210cac-2048-43dc-9a0e-3c36160f2148"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Sequence Initialization", "Subsection",
 CellChangeTimes->{{3.855392372789317*^9, 3.8553923987099037`*^9}, {
  3.869299284673504*^9, 3.8692992855089607`*^9}, {3.970506775538338*^9, 
  3.9705067804546328`*^9}},ExpressionUUID->"e0c4af7e-9127-48cd-95b7-\
58f9e3fd9080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Works", " ", "on", " ", "an", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getImageBubbleSegments", "[", "image_", "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"global", " ", "filter"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"globalFilteredImage", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"GaussianFilter", "[", 
          RowBox[{"#", ",", "globalGaussianFilterScale"}], "]"}], "&"}], "@", 
        "image"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"globalSegments", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteBorderComponents", "@", 
          RowBox[{"Binarize", "[", 
           RowBox[{"#", ",", "globalThresholdAggregated"}], "]"}]}], "&"}], 
        "@", "globalFilteredImage"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"first", " ", "segmentation"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"globalSegmentData", " ", "=", " ", 
       RowBox[{"getSegmentData", "@", "globalSegments"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "local", " ", "filtering", " ", "and", " ", "image", " ", "remap"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "globalSegmentData"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"boxes", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"newBox", "@", 
              RowBox[{"Last", "@", 
               RowBox[{"Flatten", "[", 
                RowBox[{"#", ",", "1"}], "]"}]}]}], "&"}], "/@", 
            "globalSegmentData"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"boxCenters", "=", 
           RowBox[{"boxCenter", "/@", "boxes"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"windows", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageTrim", "[", 
               RowBox[{"image", ",", "#"}], "]"}], "&"}], "/@", "boxes"}], 
            ")"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"windowsFiltered", " ", "=", 
           RowBox[{"localFilter", "/@", "windows"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"onCanvas", " ", "=", 
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageCompose", "[", 
               RowBox[{"blackCanvas", ",", "#1", ",", "#2"}], "]"}], "&"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"windowsFiltered", ",", "boxCenters"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageAdd", "[", "onCanvas", "]"}]}], "\[IndentingNewLine]",
          ")"}], ",", "\[IndentingNewLine]", "blackCanvas"}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.844327947132184*^9, 3.844327993532775*^9}, {
   3.844328068509672*^9, 3.844328086460628*^9}, {3.844328157287871*^9, 
   3.844328184029101*^9}, {3.84432922069366*^9, 3.844329406395509*^9}, {
   3.844329719343751*^9, 3.844329721361863*^9}, {3.8443299100997*^9, 
   3.84432995293017*^9}, 3.844330314590372*^9, {3.844331801367824*^9, 
   3.844331803574844*^9}, 3.8443318887053432`*^9, {3.844344362002143*^9, 
   3.844344365358268*^9}, {3.8444758321829777`*^9, 3.844475836522172*^9}, {
   3.844476636608193*^9, 3.8444766711707363`*^9}, {3.844476717143077*^9, 
   3.8444767543435793`*^9}, {3.844476793411387*^9, 3.844476847033173*^9}, {
   3.8444771700990868`*^9, 3.844477177245574*^9}, {3.844490174909404*^9, 
   3.844490256357587*^9}, 3.844490286846259*^9, {3.844491932433262*^9, 
   3.844491936317299*^9}, {3.844510329775901*^9, 3.844510341878995*^9}, {
   3.844510792704219*^9, 3.8445108814217663`*^9}, {3.844776207760549*^9, 
   3.8447762267697268`*^9}, {3.844777025792883*^9, 3.8447770424727173`*^9}, {
   3.844950017589574*^9, 3.844950022993186*^9}, 3.8450189935432463`*^9, 
   3.851165446813231*^9, 3.851165492426255*^9, {3.851410453094966*^9, 
   3.851410456504076*^9}, {3.851759417778524*^9, 3.8517594794090776`*^9}, {
   3.851759538881502*^9, 3.8517596926437902`*^9}, {3.8517597493089457`*^9, 
   3.851759754264937*^9}, {3.855255811138956*^9, 3.8552558359551687`*^9}, {
   3.860047956749874*^9, 3.8600479885549583`*^9}, {3.8600500082357397`*^9, 
   3.86005001484288*^9}, 3.860052612167486*^9, 3.86224096726058*^9, {
   3.8622478875722446`*^9, 3.862247912465518*^9}, {3.862521364309702*^9, 
   3.862521404975964*^9}, {3.862523989235916*^9, 3.862524016561905*^9}, {
   3.862524224913505*^9, 3.862524253563901*^9}, {3.862914735192995*^9, 
   3.862914751136565*^9}, {3.8629354379696827`*^9, 3.862935445122716*^9}, {
   3.862947581637824*^9, 3.862947604896407*^9}, {3.8692992579302692`*^9, 
   3.8692993041911077`*^9}, {3.8707885015759945`*^9, 
   3.8707885170346594`*^9}, {3.9566764460912843`*^9, 3.956676451922365*^9}, 
   3.97080413021025*^9, {3.9708042949076524`*^9, 3.970804305016139*^9}, {
   3.9708044252082386`*^9, 3.970804480484455*^9}, {3.970804530613612*^9, 
   3.9708045306292353`*^9}, {3.970804564157398*^9, 3.9708045683289213`*^9}, 
   3.9708048959893217`*^9, 3.970828065660649*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"a957005f-7f39-4070-9f17-9d0681a6a928"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Processing Sequence Definition", "Section",
 CellChangeTimes->{{3.8445078246768427`*^9, 3.844507839762246*^9}, {
   3.845791585994466*^9, 3.845791594672381*^9}, {3.869298020893303*^9, 
   3.869298021174493*^9}, {3.869298077133464*^9, 3.869298099808764*^9}, 
   3.956675751736621*^9, {3.956676512498578*^9, 3.956676514224929*^9}, {
   3.9705067828888154`*^9, 
   3.9705067836684384`*^9}},ExpressionUUID->"9fe9be40-4d96-49c8-b592-\
2dd3ed17322d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"processor", "[", "inputImageFolder_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"image", " ", "import"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"subFolder", "=", 
      RowBox[{
      "batchDirectory", "<>", "inputImageFolder", "<>", "\"\</\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "@", "subFolder"}], ";", "\[IndentingNewLine]", 
     RowBox[{"files", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"FileNames", "[", "]"}], ",", 
        RowBox[{
         RowBox[{"ToExpression", "@", 
          RowBox[{"FileBaseName", "@", "#"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"importFiles", "=", 
      RowBox[{"files", "[", 
       RowBox[{"[", 
        RowBox[{"lowerLimit", ";;", "upperLimit"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", "     ", 
     RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Image import\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"images", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", 
               RowBox[{"Last", "@", 
                RowBox[{"Last", "@", 
                 RowBox[{"Normal", "@", 
                  RowBox[{"Import", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"subFolder", "<>", "#"}], ",", 
                    RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
                   "\[IndentingNewLine]", "]"}]}]}]}]}], ")"}], "&"}], "/@", 
            "importFiles"}], "//", "Parallelize"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "importFiles"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemoryAvailable", "[", "]"}], "/", 
        RowBox[{"1024.", "^", "3."}]}], ",", "\"\< GiB\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\n", "     ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"widthPixels", ",", "heightPixels"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "@", 
         RowBox[{"ImageDimensions", "@", 
          RowBox[{"First", "@", "images"}]}]}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"First", ",", "Last"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"blackCanvas", "=", 
      RowBox[{"Binarize", "[", 
       RowBox[{
        RowBox[{"First", "@", "images"}], ",", " ", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Global thresholding\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"globalThresholdsPerImage", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", 
               RowBox[{"FindThreshold", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Method", "\[Rule]", "\"\<Entropy\>\""}]}], "]"}]}], 
              "\[IndentingNewLine]", ")"}], "&"}], "/@", "images"}], "//", 
           "Parallelize"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "images"}]}], "]"}]}], "\[IndentingNewLine]",
        "]"}], "//", "AbsoluteTiming"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"globalThresholdAggregated", "=", 
      RowBox[{"Mean", "@", "globalThresholdsPerImage"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Image", " ", "processing"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Local thresholding\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"bubblesFromBase", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"monitorCounter", "++"}], ";", " ", 
               RowBox[{"getImageBubbleSegments", "@", "#"}]}], 
              "\[IndentingNewLine]", ")"}], "&"}], "/@", "images"}], "//", 
           "Parallelize"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "images"}]}], "]"}]}], "\[IndentingNewLine]",
        "]"}], "//", "AbsoluteTiming"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Images processed \>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemoryAvailable", "[", "]"}], "/", 
        RowBox[{"1024.", "^", "3."}]}], ",", "\"\< GiB\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Mask", " ", "export"}], "*)"}], "\n", "     ", 
     RowBox[{"batchName", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", " ", 
          RowBox[{"\"\<.\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "&"}], "@", 
       "inputImageFolder"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"batchDirectory", "<>", "\"\<3 Bubble Masks\\\\\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectoryQ", "@", "output"}], ",", "\[IndentingNewLine]", 
       "Nothing", ",", "\[IndentingNewLine]", 
       RowBox[{"output", "//", "CreateDirectory"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\n", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Exporting masks\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"monitorCounter", "=", "0"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Monitor", "["}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "@", "bubblesFromBase"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"output", "<>", "\"\<Frame_\>\"", "<>", 
           RowBox[{"ToString", "@", "k"}], "<>", "\"\<.png\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"bubblesFromBase", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{";", "\[IndentingNewLine]", 
           RowBox[{"monitorCounter", "++"}], ";"}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"progress", "[", 
          RowBox[{"monitorCounter", ",", 
           RowBox[{"Length", "@", "bubblesFromBase"}]}], "]"}]}], "*)"}], 
       "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemoryAvailable", "[", "]"}], "/", 
        RowBox[{"1024.", "^", "3."}]}], ",", "\"\< GiB\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Generating overlays\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"monitorCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Create", " ", 
       RowBox[{"overlays", " ", "--"}], " ", "optional"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"segmentOverlays", " ", "=", 
          RowBox[{"Parallelize", "@", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"ImageAdd", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Image", "[", 
                    RowBox[{"#", ",", "\"\<Byte\>\""}], "]"}], "&"}], "@", 
                   "#1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ColorReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"White", "\[Rule]", "Red"}]}], "]"}], "&"}], "@", 
                   
                   RowBox[{"EdgeDetect", "@", "#2"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], ")"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"images", ",", "bubblesFromBase"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ";"}], ",", 
        RowBox[{"progress", "[", 
         RowBox[{"monitorCounter", ",", 
          RowBox[{"Length", "@", "images"}]}], "]"}]}], "\[IndentingNewLine]",
        "]"}], "//", "AbsoluteTiming"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"batchDirectory", "<>", "\"\<4 Bubble Overlays\\\\\>\""}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DirectoryQ", "@", "output"}], ",", "\[IndentingNewLine]", 
       "Nothing", ",", "\[IndentingNewLine]", 
       RowBox[{"output", "//", "CreateDirectory"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"monitorCounter", "=", "0"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Exporting overlays\>\"", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Monitor", "["}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "@", "bubblesFromBase"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"output", "<>", "\"\<Frame_\>\"", "<>", 
           RowBox[{"ToString", "@", "k"}], "<>", "\"\<.jpg\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"segmentOverlays", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{";", "\[IndentingNewLine]", 
           RowBox[{"monitorCounter", "++"}], ";"}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"progress", "[", 
          RowBox[{"monitorCounter", ",", 
           RowBox[{"Length", "@", "segmentOverlays"}]}], "]"}]}], "*)"}], 
       "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemoryAvailable", "[", "]"}], "/", 
        RowBox[{"1024.", "^", "3."}]}], ",", "\"\< GiB\>\""}], "]"}], ";"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.751367533932418*^9}, 3.7513678787540135`*^9, {3.751368682841755*^9, 
   3.751368710653499*^9}, {3.7513689560071154`*^9, 3.751368969333048*^9}, {
   3.7513702998183403`*^9, 3.7513703169215965`*^9}, {3.751370787710986*^9, 
   3.7513707969726477`*^9}, {3.751694728455764*^9, 3.7516947508282638`*^9}, {
   3.7516956463966684`*^9, 3.751695664837387*^9}, {3.7517117899960823`*^9, 
   3.751711790208119*^9}, {3.751715307345482*^9, 3.7517153142250805`*^9}, {
   3.751717768351387*^9, 3.7517178095255127`*^9}, {3.7517178904197807`*^9, 
   3.751717892263572*^9}, {3.751718021858073*^9, 3.7517180449997435`*^9}, 
   3.7517958177090473`*^9, {3.7517962384460444`*^9, 3.751796247771106*^9}, {
   3.751798356897586*^9, 3.751798359319228*^9}, {3.7518003178915434`*^9, 
   3.751800322200385*^9}, {3.7518054063190494`*^9, 3.751805413644461*^9}, {
   3.7518090738015766`*^9, 3.7518090780190587`*^9}, {3.751809128739005*^9, 
   3.7518091377363367`*^9}, {3.751809633506062*^9, 3.7518097128353043`*^9}, {
   3.751809747610074*^9, 3.751809763471615*^9}, {3.7518098013434286`*^9, 
   3.7518098312315564`*^9}, 3.75181018092091*^9, {3.751810440182747*^9, 
   3.7518104638003564`*^9}, {3.7518104975231147`*^9, 
   3.7518105003860273`*^9}, {3.7518706948423195`*^9, 
   3.7518706950687003`*^9}, {3.7518710217670946`*^9, 
   3.7518710268604765`*^9}, {3.751879180640204*^9, 3.751879198671009*^9}, {
   3.751954609915016*^9, 3.7519546122218122`*^9}, {3.7519574350255146`*^9, 
   3.7519574378918285`*^9}, {3.751957531661088*^9, 3.75195753194832*^9}, 
   3.7519739381155186`*^9, {3.751974564149325*^9, 3.7519745737382736`*^9}, {
   3.7519746061642714`*^9, 3.7519746074588327`*^9}, {3.7519863533188334`*^9, 
   3.7519863536130424`*^9}, {3.751986413477455*^9, 3.7519864235716724`*^9}, {
   3.7519870974555826`*^9, 3.7519871318905077`*^9}, {3.7520039790994835`*^9, 
   3.75200399610083*^9}, 3.752050298923599*^9, {3.7520514591520195`*^9, 
   3.752051513645871*^9}, {3.7520515810146384`*^9, 3.7520516070481863`*^9}, {
   3.7520517026397276`*^9, 3.7520517030814557`*^9}, {3.752051745263569*^9, 
   3.7520517836363487`*^9}, 3.752071268552267*^9, 3.7522119243556566`*^9, {
   3.760172950640916*^9, 3.760172954195407*^9}, {3.7601730596555715`*^9, 
   3.7601730603896136`*^9}, {3.760173095951811*^9, 3.7601731098661714`*^9}, {
   3.7601732070097156`*^9, 3.760173207577176*^9}, {3.7608967010022516`*^9, 
   3.760896713375206*^9}, {3.760929196843571*^9, 3.760929229387312*^9}, 
   3.7609305771199694`*^9, {3.76093208087411*^9, 3.760932116185805*^9}, {
   3.76093218508365*^9, 3.7609322280421505`*^9}, {3.760932258883037*^9, 
   3.7609322613026257`*^9}, {3.7609324644993386`*^9, 3.760932476353635*^9}, 
   3.760948494764584*^9, {3.760954822229915*^9, 3.760954828183131*^9}, {
   3.760957174116322*^9, 3.7609571745322294`*^9}, {3.760957895235751*^9, 
   3.760957921379594*^9}, {3.7609651595617104`*^9, 3.7609651654958453`*^9}, {
   3.7613977902309713`*^9, 3.7613977942121305`*^9}, {3.7614005950165224`*^9, 
   3.761400595718647*^9}, 3.766941086103475*^9, {3.766941253319908*^9, 
   3.766941267420458*^9}, {3.7669413812977057`*^9, 3.7669413828107724`*^9}, {
   3.766991390999523*^9, 3.7669913930191407`*^9}, 3.767012354908183*^9, 
   3.781935806390972*^9, 3.781936033385374*^9, 3.7819360705919476`*^9, 
   3.781936103022912*^9, {3.7819364081089644`*^9, 3.781936410955409*^9}, {
   3.7819367452987604`*^9, 3.7819367622895584`*^9}, {3.7819368721284275`*^9, 
   3.7819368997005873`*^9}, {3.78256209209163*^9, 3.782562093890131*^9}, {
   3.844257799340705*^9, 3.844257813457425*^9}, {3.8553920078497667`*^9, 
   3.855392012814232*^9}, {3.856250191201414*^9, 3.856250232703102*^9}, {
   3.8562520431182947`*^9, 3.856252141381493*^9}, {3.856252203719722*^9, 
   3.856252255915289*^9}, {3.856252300863139*^9, 3.856252305392064*^9}, {
   3.856252352196966*^9, 3.8562523888538857`*^9}, {3.856252446343231*^9, 
   3.8562524895773783`*^9}, {3.8562553818556347`*^9, 3.856255409433647*^9}, {
   3.856256366655346*^9, 3.856256382108848*^9}, {3.856257008256236*^9, 
   3.856257010794084*^9}, {3.856257303136685*^9, 3.856257354834614*^9}, {
   3.856257774714705*^9, 3.8562579213044643`*^9}, {3.856257994277404*^9, 
   3.856258020270615*^9}, {3.856258089739832*^9, 3.856258132265641*^9}, {
   3.8562581913408937`*^9, 3.856258237797119*^9}, {3.856258271983555*^9, 
   3.856258295413122*^9}, {3.856258365182643*^9, 3.8562583752102213`*^9}, {
   3.856258687450672*^9, 3.85625876406513*^9}, {3.856259620096257*^9, 
   3.856259683887211*^9}, 3.8562708470666122`*^9, {3.859021745750124*^9, 
   3.8590217499397583`*^9}, {3.859103445801277*^9, 3.859103491056922*^9}, {
   3.859103596619948*^9, 3.8591035975827913`*^9}, {3.8591036326916313`*^9, 
   3.859103638582407*^9}, {3.859451511333824*^9, 3.859451515423167*^9}, {
   3.859451592850288*^9, 3.85945160401833*^9}, {3.859451850580456*^9, 
   3.859451879730114*^9}, 3.859451950169718*^9, 3.859452522522209*^9, 
   3.86004606069128*^9, {3.86004610376902*^9, 3.8600461477185793`*^9}, {
   3.860046448959958*^9, 3.860046558255125*^9}, 3.860046606719643*^9, {
   3.8600466743704977`*^9, 3.86004668326213*^9}, {3.8600467713400106`*^9, 
   3.860046771813838*^9}, {3.86004708146483*^9, 3.860047094976729*^9}, {
   3.860050046917284*^9, 3.860050144811077*^9}, {3.8600591063930283`*^9, 
   3.860059111141946*^9}, {3.860059144816346*^9, 3.860059154307877*^9}, {
   3.860059189230633*^9, 3.860059198471508*^9}, {3.8600593175543013`*^9, 
   3.860059380249292*^9}, {3.8600594380314627`*^9, 3.860059456766239*^9}, {
   3.860059508947998*^9, 3.860059522156027*^9}, 3.860078446986199*^9, 
   3.860741938210567*^9, {3.860742677818672*^9, 3.860742680045698*^9}, {
   3.860742903361553*^9, 3.860742919820343*^9}, {3.860744409385338*^9, 
   3.8607444399598227`*^9}, 3.8607444720057163`*^9, 3.8629475255316467`*^9, {
   3.8692993412799187`*^9, 3.869299398279628*^9}, {3.869299471886497*^9, 
   3.869299519895006*^9}, {3.870788594259224*^9, 3.8707886433076973`*^9}, {
   3.870789036708892*^9, 3.8707890735065117`*^9}, 3.8707898968360634`*^9, {
   3.8707901752169447`*^9, 3.870790177837435*^9}, {3.8707902417937965`*^9, 
   3.870790243755803*^9}, {3.956675624298761*^9, 3.9566756266433945`*^9}, 
   3.956675932810293*^9, {3.95667597466556*^9, 3.956675983729862*^9}, {
   3.9566762508115444`*^9, 3.9566762511855445`*^9}, {3.9566765978136272`*^9, 
   3.9566765980594983`*^9}, {3.9566768749005594`*^9, 3.956676911363346*^9}, 
   3.9705035748433585`*^9, {3.9705047578200693`*^9, 3.9705048289220057`*^9}, {
   3.970505848402684*^9, 3.9705059643864307`*^9}, {3.9705060075897655`*^9, 
   3.9705060141623745`*^9}, {3.970506054181425*^9, 3.9705060543138857`*^9}, {
   3.9705060906806526`*^9, 3.970506151485653*^9}, {3.9705065103247175`*^9, 
   3.9705065219954414`*^9}, {3.970506685041483*^9, 3.9705066880758977`*^9}, {
   3.9705067217081275`*^9, 3.9705067392594194`*^9}, {3.970506958098019*^9, 
   3.9705069609960365`*^9}, {3.9705075436861553`*^9, 
   3.9705075615544853`*^9}, {3.9705076689947968`*^9, 
   3.9705076886270885`*^9}, {3.9705437366866384`*^9, 
   3.9705437702829447`*^9}, {3.970543810787363*^9, 3.970543953596327*^9}, {
   3.9705439981495934`*^9, 3.970544031572441*^9}, {3.9705483195786395`*^9, 
   3.9705483231320133`*^9}, {3.970549604992649*^9, 3.9705497689417987`*^9}, {
   3.9705498106878867`*^9, 3.9705498117321105`*^9}, {3.9706532395482283`*^9, 
   3.9706532663813686`*^9}, 3.9708044232239647`*^9, {3.9708048680239916`*^9, 
   3.970804894848751*^9}, {3.9708175292396326`*^9, 3.970817549813881*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"e17e4c05-02ca-4e59-b6f3-9fbd557c7389"]
}, Closed]],

Cell[CellGroupData[{

Cell["Image processing", "Section",
 CellChangeTimes->{{3.751808845615265*^9, 3.75180886393727*^9}, {
  3.751808901177807*^9, 3.7518089106497416`*^9}, {3.8426073866211615`*^9, 
  3.8426073883328094`*^9}, {3.842607419564908*^9, 3.8426074208915234`*^9}, {
  3.85539217810675*^9, 3.8553922322676373`*^9}, {3.869297787524592*^9, 
  3.8692977951037283`*^9}, {3.8707878323074036`*^9, 3.870787836635366*^9}, {
  3.95667574621793*^9, 
  3.9566757479076385`*^9}},ExpressionUUID->"756c7ebd-20de-41e6-bd00-\
3fd8512ed73c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Set", " ", "input"}], ",", " ", 
    RowBox[{
    "batches", " ", "are", " ", "folders", " ", "of", " ", "images"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "batchDirectory", "=", 
     "\"\<D:\\\\Ansis Zivers\\\\X-ray Bubbles\\\\Output\\\\3 mm 2020-11-27 -- \
VFS 125 mT -- S1 -- 350 sccm\\\\\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "@", "batchDirectory"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"batches", " ", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"FileNames", "[", "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"batches", "//", "Length"}], "\[IndentingNewLine]", 
   RowBox[{"batches", "//", "TableForm", " ", 
    RowBox[{"(*", 
     RowBox[{"Prints", " ", "folders", " ", "in", " ", "batch"}], 
     "*)"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.7513674979286723`*^9}, {3.7513707604688616`*^9, 3.7513707609725127`*^9}, 
   3.751712760209059*^9, {3.751718054524271*^9, 3.751718059769699*^9}, {
   3.7518135482953935`*^9, 3.7518135725814433`*^9}, {3.7518710407937007`*^9, 
   3.751871052004719*^9}, {3.751871358211807*^9, 3.751871364445162*^9}, {
   3.751879175723353*^9, 3.7518791825590715`*^9}, {3.7519575243057594`*^9, 
   3.751957528260184*^9}, {3.7519581327610455`*^9, 3.7519581412344737`*^9}, {
   3.751958453957793*^9, 3.7519584557566743`*^9}, {3.751968334426799*^9, 
   3.7519683353822217`*^9}, {3.7519700282986717`*^9, 3.75197002848617*^9}, {
   3.7519737833049164`*^9, 3.75197380799761*^9}, {3.7519738973199735`*^9, 
   3.7519738974366484`*^9}, 3.751974453373953*^9, 3.7519744838607883`*^9, {
   3.7519745775281367`*^9, 3.7519745791647434`*^9}, {3.7519863856792855`*^9, 
   3.751986410580202*^9}, {3.751987189723457*^9, 3.7519872067171807`*^9}, {
   3.7519872740525713`*^9, 3.751987274251018*^9}, 3.7519887579797745`*^9, {
   3.7519888044417067`*^9, 3.7519888045384264`*^9}, {3.7519889388743944`*^9, 
   3.751988953257942*^9}, {3.75198898540973*^9, 3.7519889857218943`*^9}, {
   3.7519891583567*^9, 3.751989168418381*^9}, {3.751989242284319*^9, 
   3.7519892558884606`*^9}, {3.7519893723305483`*^9, 3.751989372402337*^9}, {
   3.7519931269744205`*^9, 3.7519931279248924`*^9}, {3.751993166925639*^9, 
   3.7519931670293694`*^9}, 3.75199861425095*^9, {3.7519986697422304`*^9, 
   3.7519986922896194`*^9}, {3.751999213796385*^9, 3.7519992351032796`*^9}, {
   3.7519994435814323`*^9, 3.7519994603814545`*^9}, {3.7519996162634587`*^9, 
   3.7519996233658457`*^9}, {3.7519999333676405`*^9, 
   3.7519999359958153`*^9}, {3.7520002180623083`*^9, 
   3.7520002187803435`*^9}, {3.7520002493768325`*^9, 
   3.7520002505482464`*^9}, {3.752000407725655*^9, 3.752000411067837*^9}, {
   3.7520004699823575`*^9, 3.75200047026727*^9}, {3.7520022702769604`*^9, 
   3.7520022747149506`*^9}, {3.7520046929402857`*^9, 
   3.7520046960967264`*^9}, {3.7520502955602303`*^9, 
   3.7520503446601734`*^9}, {3.7520514690035224`*^9, 
   3.7520514690514917`*^9}, {3.7520515670681887`*^9, 
   3.7520515977009263`*^9}, {3.7520517074841633`*^9, 
   3.7520517090997686`*^9}, {3.7520518266893578`*^9, 
   3.7520518310232763`*^9}, {3.7520519932426023`*^9, 
   3.7520519966515093`*^9}, {3.752211767119261*^9, 3.7522117933048677`*^9}, 
   3.7522118378507395`*^9, {3.7522119014341974`*^9, 3.7522119154280024`*^9}, {
   3.752211947983062*^9, 3.7522119754180403`*^9}, {3.75238986004722*^9, 
   3.7523898600877047`*^9}, 3.759935401921358*^9, {3.7600950420507*^9, 
   3.7600950507155514`*^9}, 3.76009546165426*^9, {3.760097847762862*^9, 
   3.7600978479823008`*^9}, {3.7601571295604706`*^9, 3.760157129648235*^9}, 
   3.7601592766146355`*^9, {3.7601729472799244`*^9, 3.760172947511306*^9}, {
   3.7601732107197742`*^9, 3.760173211161602*^9}, 3.760175621125779*^9, 
   3.7602497894762554`*^9, 3.7602549941536517`*^9, 3.7602587711196823`*^9, {
   3.760269954882045*^9, 3.760269955256042*^9}, {3.7602794081805344`*^9, 
   3.760279410170213*^9}, {3.7602794702182603`*^9, 3.7602794767148857`*^9}, {
   3.7603410399150243`*^9, 3.760341041124792*^9}, {3.7604556788470125`*^9, 
   3.760455727922307*^9}, {3.7607682966617975`*^9, 3.760768308975419*^9}, 
   3.7607854536095047`*^9, {3.7608865838057194`*^9, 3.760886593361717*^9}, {
   3.7608866844010015`*^9, 3.7608866845675573`*^9}, {3.760887388038473*^9, 
   3.7608873882957788`*^9}, {3.760892595971661*^9, 3.7608926320929804`*^9}, {
   3.760929281108795*^9, 3.7609292932042255`*^9}, {3.7609293967314425`*^9, 
   3.7609294116522813`*^9}, {3.7609299152508698`*^9, 
   3.7609299156738005`*^9}, {3.760929954547063*^9, 3.7609300117870555`*^9}, {
   3.7609305684759817`*^9, 3.7609305685647535`*^9}, {3.7609314858821344`*^9, 
   3.7609314866510773`*^9}, {3.76093194642652*^9, 3.7609320560911016`*^9}, {
   3.7609321259960537`*^9, 3.760932174706381*^9}, {3.760932243970749*^9, 
   3.7609322520343113`*^9}, {3.7609322828032403`*^9, 
   3.7609322830575356`*^9}, {3.7609323214867444`*^9, 3.760932328043228*^9}, {
   3.7609324262318645`*^9, 3.760932446891398*^9}, {3.7609325111705904`*^9, 
   3.7609325119006367`*^9}, {3.760932875991317*^9, 3.760932877280859*^9}, 
   3.7609344640420094`*^9, {3.7609346032407713`*^9, 3.7609346068281736`*^9}, 
   3.7609433236004734`*^9, {3.760956474733452*^9, 3.760956588831177*^9}, {
   3.760957423846837*^9, 3.760957424285645*^9}, {3.7609580829565725`*^9, 
   3.760958083252755*^9}, {3.7609624911993523`*^9, 3.760962491368901*^9}, 
   3.760964457907423*^9, {3.7609646733113832`*^9, 3.7609646739666595`*^9}, {
   3.7612251729077897`*^9, 3.761225175298395*^9}, 3.761228707061983*^9, {
   3.761228758894994*^9, 3.7612287693206973`*^9}, 3.76122887626292*^9, {
   3.761241692049399*^9, 3.761241700577155*^9}, {3.761276326824277*^9, 
   3.7612763974426746`*^9}, {3.761276432872349*^9, 3.7612764775169487`*^9}, {
   3.7612946605842495`*^9, 3.761294670639862*^9}, {3.761299408431904*^9, 
   3.761299408500719*^9}, {3.7612996367268124`*^9, 3.7612996374924726`*^9}, {
   3.761300049404646*^9, 3.7613000513349247`*^9}, 3.7613041176850076`*^9, {
   3.7613180259074817`*^9, 3.7613180299262967`*^9}, {3.761326801495341*^9, 
   3.761326801590087*^9}, {3.761361249393982*^9, 3.7613612743078856`*^9}, 
   3.761361637701935*^9, 3.7613688777915*^9, {3.7613702345313025`*^9, 
   3.761370234824539*^9}, 3.7613711538469987`*^9, {3.7613717056648607`*^9, 
   3.761371739016631*^9}, {3.7613737377183404`*^9, 3.761373764221431*^9}, {
   3.7613739329982166`*^9, 3.7613739347046556`*^9}, {3.76138015596413*^9, 
   3.7613801562354217`*^9}, 3.7613846372534046`*^9, 3.7613861252512884`*^9, {
   3.761386510741501*^9, 3.761386512992342*^9}, {3.76138735930517*^9, 
   3.7613873604308023`*^9}, 3.7613919238287992`*^9, {3.7613966008619995`*^9, 
   3.761396602922511*^9}, {3.761397681510357*^9, 3.7613977017222805`*^9}, {
   3.761397741281606*^9, 3.7613977420625305`*^9}, 3.761458322673535*^9, {
   3.7614808507366533`*^9, 3.761480850863311*^9}, {3.761481217958542*^9, 
   3.761481218006412*^9}, {3.761481391522843*^9, 3.7614813917023582`*^9}, {
   3.7616463961540794`*^9, 3.7616463965540085`*^9}, {3.7616466354593477`*^9, 
   3.7616466372246256`*^9}, 3.7616469120822287`*^9, {3.7616469825807066`*^9, 
   3.7616469828070736`*^9}, 3.7616471557855463`*^9, {3.7616474401845856`*^9, 
   3.7616474403651204`*^9}, {3.7669408858877015`*^9, 
   3.7669409039843745`*^9}, {3.766941304508911*^9, 3.766941317480905*^9}, {
   3.7669421675895166`*^9, 3.7669421679592876`*^9}, {3.7669422723714056`*^9, 
   3.7669422852215776`*^9}, 3.7693096869252996`*^9, {3.7693121239866257`*^9, 
   3.769312124973962*^9}, {3.770495826828769*^9, 3.7704958272831993`*^9}, {
   3.770496682805866*^9, 3.7704966853412914`*^9}, 3.7704972485030303`*^9, {
   3.772348615909038*^9, 3.7723486259132843`*^9}, {3.7723569128808775`*^9, 
   3.7723569371043353`*^9}, 3.772357142969572*^9, {3.773302667131933*^9, 
   3.7733026751664457`*^9}, 3.7733110313379755`*^9, {3.773313780313419*^9, 
   3.7733138221432843`*^9}, {3.773314248470578*^9, 3.7733142486251464`*^9}, {
   3.7733142787356873`*^9, 3.773314292375209*^9}, 3.77331446898584*^9, 
   3.7733158643634233`*^9, 3.773384309726469*^9, {3.7733843768285084`*^9, 
   3.773384377838806*^9}, {3.7733844281663017`*^9, 3.773384449669899*^9}, {
   3.773385380102294*^9, 3.7733853802798233`*^9}, {3.773385937875291*^9, 
   3.773385938044855*^9}, {3.7733861080067606`*^9, 3.7733861091726418`*^9}, {
   3.777997349884369*^9, 3.7779973563449507`*^9}, {3.7779996736864486`*^9, 
   3.7779996945889626`*^9}, {3.778000628153318*^9, 3.77800062846565*^9}, {
   3.778910686621645*^9, 3.778910697341301*^9}, 3.778912337336089*^9, 
   3.7789123768874874`*^9, {3.7789159986463156`*^9, 3.7789160026207256`*^9}, {
   3.7809872939257684`*^9, 3.7809873006298585`*^9}, {3.780987475485282*^9, 
   3.78098747556008*^9}, {3.7809896040832243`*^9, 3.780989604150044*^9}, {
   3.781935631264923*^9, 3.7819357387741823`*^9}, {3.781935786817588*^9, 
   3.781935789483755*^9}, {3.781935822050601*^9, 3.781935844021475*^9}, 
   3.781935952957399*^9, {3.7819360298904686`*^9, 3.781936152963578*^9}, {
   3.781936269545663*^9, 3.781936273291142*^9}, {3.7819363239942007`*^9, 
   3.7819363715786777`*^9}, {3.7819364243604083`*^9, 3.781936490311517*^9}, {
   3.7819365596095605`*^9, 3.781936596070054*^9}, {3.7819366925687356`*^9, 
   3.7819366957739286`*^9}, {3.7819368052746944`*^9, 3.781936807140668*^9}, {
   3.781936859476156*^9, 3.781936863401528*^9}, {3.7819416869917955`*^9, 
   3.7819417112924576`*^9}, {3.782543730338276*^9, 3.7825437436547947`*^9}, {
   3.7825445288316917`*^9, 3.7825445413330674`*^9}, {3.782549525253271*^9, 
   3.7825495759256086`*^9}, 3.782550829225337*^9, 3.7825510657753696`*^9, {
   3.7825610200080705`*^9, 3.782561029255045*^9}, {3.782561330183058*^9, 
   3.7825613307435355`*^9}, {3.7825621095052013`*^9, 
   3.7825621437652845`*^9}, {3.782562204700952*^9, 3.782562240849332*^9}, {
   3.7825623277982025`*^9, 3.782562329644215*^9}, {3.782562394600174*^9, 
   3.7825623991765485`*^9}, {3.782562555569565*^9, 3.782562586701932*^9}, {
   3.782811721951993*^9, 3.78281173300521*^9}, {3.782811806833519*^9, 
   3.7828118474077225`*^9}, {3.7828118863261986`*^9, 3.782811886544095*^9}, {
   3.78281216649263*^9, 3.7828121743060193`*^9}, {3.782812285957327*^9, 
   3.782812310254076*^9}, {3.782905628363512*^9, 3.7829056766168594`*^9}, {
   3.7829057346254635`*^9, 3.782905736966573*^9}, {3.7829541779702463`*^9, 
   3.782954178967338*^9}, {3.78295495311665*^9, 3.782954960798777*^9}, 
   3.783318420161974*^9, {3.783318592271903*^9, 3.7833185995539093`*^9}, {
   3.7833186779453497`*^9, 3.783318678257719*^9}, {3.7833392025862613`*^9, 
   3.7833392047583385`*^9}, {3.783339263051766*^9, 3.7833392655205774`*^9}, {
   3.7836865941072903`*^9, 3.7836866002947683`*^9}, {3.783686712826186*^9, 
   3.7836867178144765`*^9}, {3.7836867657394342`*^9, 3.7836867657785387`*^9}, 
   3.783687283264184*^9, {3.7836874026207447`*^9, 3.7836874027049575`*^9}, {
   3.783687604715908*^9, 3.783687606035407*^9}, {3.783690156587172*^9, 
   3.783690156887972*^9}, {3.783775559742628*^9, 3.783775565458743*^9}, 
   3.7838403790244675`*^9, {3.783840817865399*^9, 3.7838408183406677`*^9}, {
   3.7838409041394987`*^9, 3.7838409079737425`*^9}, {3.783840999613789*^9, 
   3.783841000758848*^9}, {3.7838411538186135`*^9, 3.783841169385147*^9}, {
   3.783841260332086*^9, 3.7838412603942523`*^9}, {3.783841443005767*^9, 
   3.7838414437407427`*^9}, 3.7839189602328396`*^9, {3.783918993528123*^9, 
   3.7839189935776834`*^9}, {3.783921394659896*^9, 3.783921395575432*^9}, {
   3.7839217286527004`*^9, 3.783921735277869*^9}, {3.7839314390562525`*^9, 
   3.7839314415103645`*^9}, {3.7839354079410405`*^9, 3.78393548147972*^9}, 
   3.7842903496261168`*^9, 3.784292608699628*^9, {3.784292658412279*^9, 
   3.784292662423986*^9}, {3.784292828983741*^9, 3.7842928320539427`*^9}, {
   3.784298737150395*^9, 3.7842987508490076`*^9}, {3.7843036626957164`*^9, 
   3.784303662775931*^9}, 3.7843272589156914`*^9, {3.7843275909060335`*^9, 
   3.7843275912402177`*^9}, {3.7843591557525606`*^9, 
   3.7843591557659545`*^9}, {3.784386027858904*^9, 3.784386031639289*^9}, {
   3.7843919626786337`*^9, 3.7843919627282486`*^9}, 3.784403184161606*^9, 
   3.7844071042245655`*^9, {3.842588872792037*^9, 3.8425888978411617`*^9}, {
   3.843875638052524*^9, 3.843875661849861*^9}, 3.844507229481266*^9, {
   3.845035801008132*^9, 3.845035805843377*^9}, {3.8450382118847113`*^9, 
   3.84503821515665*^9}, {3.84503842497435*^9, 3.845038446050909*^9}, {
   3.845084210927106*^9, 3.84508421117356*^9}, {3.845112687313458*^9, 
   3.84511268755442*^9}, {3.845114719936674*^9, 3.845114720002236*^9}, {
   3.845115702138193*^9, 3.8451157022150993`*^9}, {3.845116687638585*^9, 
   3.845116687721293*^9}, {3.845118985972445*^9, 3.845118986056671*^9}, {
   3.845120808246766*^9, 3.845120812006054*^9}, {3.845787898673205*^9, 
   3.84578790103152*^9}, {3.845791710200428*^9, 3.8457917209660673`*^9}, {
   3.8502989742301683`*^9, 3.850298974618709*^9}, {3.851146621360949*^9, 
   3.85114663188135*^9}, {3.851165396420528*^9, 3.851165397574546*^9}, {
   3.851165522448071*^9, 3.851165527132092*^9}, {3.851167839090938*^9, 
   3.851167839528161*^9}, {3.85116807302209*^9, 3.851168096360923*^9}, {
   3.85125684849809*^9, 3.851256849315588*^9}, {3.851257136983713*^9, 
   3.851257137393353*^9}, 3.851416788917988*^9, {3.851436177429657*^9, 
   3.851436190092196*^9}, {3.851491656249277*^9, 3.851491676529953*^9}, {
   3.851494345875263*^9, 3.851494367757698*^9}, {3.8552554216858377`*^9, 
   3.855255431453865*^9}, {3.855382004875628*^9, 3.8553820365855618`*^9}, {
   3.855391256596958*^9, 3.855391264209152*^9}, {3.855391303552845*^9, 
   3.85539130413202*^9}, {3.8557293033159647`*^9, 3.855729317759015*^9}, {
   3.855729377956114*^9, 3.855729397602292*^9}, {3.855729502706747*^9, 
   3.855729505315651*^9}, {3.855729692733131*^9, 3.855729711371088*^9}, {
   3.85572975637493*^9, 3.85572977753918*^9}, {3.855729837498407*^9, 
   3.8557298481118*^9}, {3.856249390847074*^9, 3.856249437039401*^9}, {
   3.856249486786076*^9, 3.85624960495793*^9}, {3.8562499255168123`*^9, 
   3.856249944509707*^9}, {3.856252289743327*^9, 3.8562522927056837`*^9}, {
   3.856254748817528*^9, 3.856254782830542*^9}, {3.856255285725709*^9, 
   3.856255289154048*^9}, {3.856268313370656*^9, 3.8562683435110283`*^9}, {
   3.8562683919993057`*^9, 3.8562684053174667`*^9}, {3.859021672351989*^9, 
   3.859021681643783*^9}, {3.859451425847169*^9, 3.8594514351375723`*^9}, {
   3.860045958434455*^9, 3.860045960493469*^9}, {3.860045995381274*^9, 
   3.860045996580369*^9}, {3.8600498451758375`*^9, 3.860049855711029*^9}, 
   3.8600498986090145`*^9, {3.860049950356762*^9, 3.860049954671027*^9}, {
   3.8600588117248917`*^9, 3.860058834112878*^9}, 3.860059040764468*^9, {
   3.8600596120856943`*^9, 3.860059619659663*^9}, {3.860060030197404*^9, 
   3.860060035079748*^9}, {3.860078517566392*^9, 3.86007853473974*^9}, {
   3.860741813770084*^9, 3.860741817282125*^9}, 3.8607418602949266`*^9, 
   3.860744350617853*^9, {3.8622410041123123`*^9, 3.862241023256938*^9}, {
   3.86291444972351*^9, 3.862914450674755*^9}, {3.8629470509037037`*^9, 
   3.86294709339123*^9}, {3.8629471851051483`*^9, 3.862947192455482*^9}, {
   3.869297713287373*^9, 3.869297747266222*^9}, {3.869299098431284*^9, 
   3.869299121042487*^9}, {3.870787019030633*^9, 3.870787023390145*^9}, {
   3.870787639402027*^9, 3.87078771812568*^9}, 3.870788136571521*^9, {
   3.8707884184591722`*^9, 3.8707884289094954`*^9}, {3.8707887903006134`*^9, 
   3.8707888076595945`*^9}, 3.870790224219264*^9, {3.9566754948430977`*^9, 
   3.9566755001689687`*^9}, {3.9566756862678413`*^9, 3.9566757045290775`*^9}, 
   3.956676224100937*^9, 3.95667767228253*^9, {3.970503634811885*^9, 
   3.9705036432234287`*^9}, {3.970503673481187*^9, 3.9705036797352815`*^9}, {
   3.970563142456521*^9, 3.970563143668668*^9}, 3.9706438666226363`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"a2684ece-35d2-40cb-9c20-e3102e233bf5"],

Cell["\<\
Defaults:

minimumComponentSize = 3000; 
scaleSide = 1.2;

localAdaptiveRadius = 3;
localAdaptiveMeanFactor = 0.995;
localAdaptiveDeviationFactor = 0.07;
localAdaptiveOffset = 0.0015;

repairScale = 15;

nonlocalMeansFilteringRadius = 1;
nonlocalMeansSearchRadius = 5;
localMinSize = 6000;
gradientFilterRadius = 20;
localBinRadius = 3;
addFillOpeningScale = 10;
resolveOpeningScale = 0.5;
resolveErosionScale = 1;\
\>", "Abstract",
 CellChangeTimes->{{3.9566756492327185`*^9, 3.956675666320985*^9}, {
   3.9566763263851433`*^9, 3.9566763264889708`*^9}, 3.970507506902334*^9},
 FontSize->16,ExpressionUUID->"5e23ab78-813d-459b-b9fa-2e3aac9334e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"minimumComponentSize", "=", "3000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"also", " ", "used", " ", "for", " ", "localFilter"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scaleSide", " ", "=", " ", "1.2"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "scale", " ", "modifier", " ", "of", " ", "segment", " ", "bounding", " ", 
    "box"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"globalGaussianFilterScale", "=", "3"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localAdaptiveRadius", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localAdaptiveMeanFactor", "=", "0.995"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localAdaptiveDeviationFactor", "=", "0.07"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"localAdaptiveOffset", "=", "0.0015"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"repairScale", " ", "=", " ", "15"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonlocalMeansFilteringRadius", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nonlocalMeansSearchRadius", "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"localMinSize", "=", "6000"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"also", " ", "uses", " ", "minimumComponentSize"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradientFilterRadius", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localBinRadius", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addFillOpeningScale", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resolveOpeningScale", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resolveErosionScale", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.849165468231838*^9, 3.84916547208801*^9}, {
   3.849165516340804*^9, 3.849165529890294*^9}, {3.849165626423729*^9, 
   3.849165674073311*^9}, {3.849165730700326*^9, 3.8491657420514307`*^9}, {
   3.849165778244113*^9, 3.849165788550479*^9}, {3.849165818812743*^9, 
   3.84916583006354*^9}, {3.849166085384906*^9, 3.8491661126193438`*^9}, {
   3.8491663249035673`*^9, 3.849166336479144*^9}, {3.8508086530682993`*^9, 
   3.8508086746566*^9}, {3.850808758174551*^9, 3.8508087754423723`*^9}, {
   3.850808865123225*^9, 3.8508088652622766`*^9}, 3.850810750193274*^9, 
   3.850810873080394*^9, 3.850811227662965*^9, {3.8508112648564672`*^9, 
   3.850811272755131*^9}, {3.850811395124139*^9, 3.850811395193986*^9}, {
   3.8508962963501263`*^9, 3.850896314870048*^9}, 3.850896439558076*^9, {
   3.85089839639988*^9, 3.85089842765831*^9}, {3.850898490680416*^9, 
   3.850898491774251*^9}, {3.850898798168311*^9, 3.8508987982317657`*^9}, {
   3.8508998734109697`*^9, 3.850899952612303*^9}, {3.851070586555759*^9, 
   3.851070591993224*^9}, {3.851070743980932*^9, 3.851070785762224*^9}, {
   3.8510708271497717`*^9, 3.851070843831998*^9}, {3.8511604654602613`*^9, 
   3.851160471518746*^9}, {3.8511605363230133`*^9, 3.851160561923091*^9}, {
   3.851160638621375*^9, 3.851160713213951*^9}, {3.851160773073618*^9, 
   3.8511607764362383`*^9}, {3.851160879304347*^9, 3.851160894446467*^9}, {
   3.851160946411192*^9, 3.851160950812594*^9}, {3.85116099149681*^9, 
   3.851160992706768*^9}, {3.851161284374817*^9, 3.8511612881158113`*^9}, {
   3.851161375238935*^9, 3.8511613832419033`*^9}, {3.851161502018971*^9, 
   3.851161506026701*^9}, {3.851162632882958*^9, 3.851162650444531*^9}, {
   3.851162898951083*^9, 3.851162899793001*^9}, {3.851165916643284*^9, 
   3.8511659288077517`*^9}, {3.851411001577317*^9, 3.851411002735545*^9}, {
   3.851411106248914*^9, 3.851411106659194*^9}, {3.851411149766631*^9, 
   3.851411203890164*^9}, {3.851411490338826*^9, 3.8514114923673267`*^9}, {
   3.851420215284925*^9, 3.851420287646965*^9}, {3.855392329350402*^9, 
   3.855392351954213*^9}, {3.8600479937044764`*^9, 3.860048000269642*^9}, {
   3.860048096423245*^9, 3.860048097527088*^9}, {3.8600484270621967`*^9, 
   3.8600484292707977`*^9}, {3.860058888626412*^9, 3.8600589171576653`*^9}, 
   3.862240963187581*^9, {3.862250327035775*^9, 3.862250332573162*^9}, {
   3.862290490889947*^9, 3.862290506359131*^9}, {3.8622934681701393`*^9, 
   3.8622934682535353`*^9}, 3.862293933904554*^9, 3.8622940334277353`*^9, {
   3.8622952046242847`*^9, 3.862295207118287*^9}, 3.8622952768234577`*^9, {
   3.862295371426626*^9, 3.862295374647915*^9}, {3.862296918574012*^9, 
   3.862296918713704*^9}, {3.86229718839336*^9, 3.862297204209866*^9}, 
   3.862297326439307*^9, {3.862297363810978*^9, 3.8622973693614063`*^9}, {
   3.862298154409315*^9, 3.862298162713524*^9}, {3.862298287420413*^9, 
   3.8622982880367126`*^9}, {3.862298937927034*^9, 3.8622989380882807`*^9}, 
   3.86229904304469*^9, {3.862299099465261*^9, 3.862299114870165*^9}, {
   3.8622991466212883`*^9, 3.862299158693223*^9}, {3.8622992742481318`*^9, 
   3.862299300331071*^9}, 3.8629321563676853`*^9, {3.8629329176272593`*^9, 
   3.862933004215103*^9}, {3.862933131384767*^9, 3.862933133515559*^9}, {
   3.862933607666532*^9, 3.8629338177623987`*^9}, 3.862935483217122*^9, {
   3.862935941639187*^9, 3.8629360083573236`*^9}, {3.862936113216325*^9, 
   3.862936138472087*^9}, {3.8629362907935257`*^9, 3.8629363215915203`*^9}, {
   3.862936502231299*^9, 3.862936512220972*^9}, {3.86293674807047*^9, 
   3.8629367968624697`*^9}, {3.862937898740398*^9, 3.862937912386444*^9}, {
   3.862938000323145*^9, 3.862938014470604*^9}, 3.8629381679325047`*^9, {
   3.862938206799197*^9, 3.8629382071805887`*^9}, {3.86293828951814*^9, 
   3.862938359331738*^9}, 3.8629969636382513`*^9, {3.869299235191389*^9, 
   3.86929924090233*^9}, {3.8707877858492746`*^9, 3.8707878059889774`*^9}, {
   3.8707880980434055`*^9, 3.870788099083331*^9}, {3.8707886092978525`*^9, 
   3.870788611033841*^9}, {3.8707901698900356`*^9, 3.870790170541986*^9}, {
   3.9566755987298384`*^9, 3.9566756154330893`*^9}, {3.9566763201232452`*^9, 
   3.9566763201690645`*^9}, 3.9705075250974255`*^9, 3.9705076463206663`*^9, {
   3.970804112930624*^9, 3.970804120304945*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"2808617a-5996-41b7-b076-d38e30396e84"],

Cell["\<\
Defaults:

selectedBatches=batches[[{1}]]
lowerLimit=1;
upperLimit=All;\
\>", "Abstract",
 CellChangeTimes->{{3.9566756492327185`*^9, 3.956675666320985*^9}, {
   3.9566763263851433`*^9, 3.9566763264889708`*^9}, 3.970507506902334*^9, 
   3.970578001482567*^9},
 FontSize->16,ExpressionUUID->"f1914dd5-9bcd-4006-8f04-fb791b8b2591"],

Cell[BoxData[{
 RowBox[{"selectedBatches", "=", 
  RowBox[{"batches", "[", 
   RowBox[{"[", 
    RowBox[{"{", "1", "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerLimit", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"upperLimit", "=", "All"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.970504849993949*^9, 3.9705048623366437`*^9}, {
  3.9705063602720776`*^9, 3.9705063607164106`*^9}, {3.9705076962078753`*^9, 
  3.970507710632233*^9}, {3.9706440984244423`*^9, 3.970644099299268*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"b34db014-9e9f-409f-9563-e0c7d69f6500"],

Cell[BoxData[
 RowBox[{"processor", "/@", "selectedBatches"}]], "Input",
 CellChangeTimes->{
  3.8629488111999474`*^9, {3.862950004315884*^9, 3.8629500063478394`*^9}, {
   3.862950369121449*^9, 3.862950375185299*^9}, {3.8707888460224004`*^9, 
   3.8707888502259684`*^9}, 3.8707889860814614`*^9, {3.8707899663011837`*^9, 
   3.8707899665265718`*^9}, {3.9705036884513235`*^9, 3.9705036891803255`*^9}, 
   3.970504866987537*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"5453dc0a-c04d-4cab-a88e-4eaabc52f243"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export Notebook With Parameters", "Section",
 CellChangeTimes->{{3.81668687666285*^9, 3.816686906558893*^9}, {
  3.816686977277207*^9, 3.8166869974765697`*^9}, {3.816687036853278*^9, 
  3.816687043642743*^9}, {3.817308316968192*^9, 3.8173083179675193`*^9}, {
  3.8216399876620564`*^9, 3.8216400078310995`*^9}, {3.821640060542082*^9, 
  3.8216400760864973`*^9}, {3.822370342013051*^9, 3.8223703455182457`*^9}, {
  3.842969150048052*^9, 3.8429691537910447`*^9}, {3.8615435122762966`*^9, 
  3.861543517725723*^9}, {3.890209056062702*^9, 
  3.89020905769811*^9}},ExpressionUUID->"be8a48c5-d4f9-4cb2-94df-\
dd6a1f3ee1ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"notebookID", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookSave", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"notebookSnapshot", "=", 
    RowBox[{"NotebookOpen", "@", 
     RowBox[{"NotebookFileName", "[", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"batchDirectory", "<>", "\"\<Bubble_detection_Run_\>\"", "<>", 
     RowBox[{"ToString", "@", "notebookID"}], "<>", "\"\<.pdf\>\""}], ",", 
    "\[IndentingNewLine]", "notebookSnapshot"}], "\[IndentingNewLine]", "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.861543175536664*^9, 3.8615432357785387`*^9}, {
   3.86154342636442*^9, 3.861543447540553*^9}, {3.861543590796198*^9, 
   3.8615435924374075`*^9}, {3.861798817780515*^9, 3.861798818319141*^9}, {
   3.88928857082766*^9, 3.8892885935714035`*^9}, {3.889300824400525*^9, 
   3.889300826019042*^9}, {3.8900794555092363`*^9, 3.8900794592661676`*^9}, 
   3.8902083844570394`*^9, 3.890209069048913*^9, 3.8902093067789917`*^9, {
   3.8905940957431183`*^9, 3.890594096652687*^9}, 3.8905942440505*^9, {
   3.8941325023793926`*^9, 3.8941325032889395`*^9}, {3.89469919779359*^9, 
   3.894699197823932*^9}, {3.8947136469968*^9, 3.8947136482268553`*^9}, 
   3.8948274270813093`*^9, 3.8948275185738883`*^9, 3.896442076226533*^9, 
   3.900598590743739*^9, {3.900615341286237*^9, 3.900615343204318*^9}, 
   3.9503488809520564`*^9, 3.957422974501116*^9, 3.957423111814674*^9, 
   3.957424977915574*^9, {3.9705631525267925`*^9, 3.970563153908616*^9}, {
   3.970563370142495*^9, 3.970563392334067*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"94f50959-867a-475c-892a-c0a229a9f463"]
}, Open  ]]
},
WindowSize->{766.8, 795.5999999999999},
WindowMargins->{{Automatic, -4.7999999999999545`}, {Automatic, 0}},
Visible->True,
TaggingRules->{
 "Openers" -> {"NotesSection" -> Closed}, "TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>0.95 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8045da78-64e5-41ff-bb34-ea0f8f902787"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 214, 4, 63, "Section",ExpressionUUID->"ca134099-a44f-4fdc-af75-6ea375b76f8d"],
Cell[639, 21, 18646, 294, 571, "Input",ExpressionUUID->"5bdd9b41-adda-49f7-8ac7-e53702cea021",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[19322, 320, 523, 8, 50, "Section",ExpressionUUID->"46134b1a-e07e-4140-b2c8-d07a1cf56718"],
Cell[CellGroupData[{
Cell[19870, 332, 247, 4, 50, "Subsection",ExpressionUUID->"d15ccfb4-8b6a-43d3-86cb-1fa3f92c1214"],
Cell[20120, 338, 1364, 27, 133, "Input",ExpressionUUID->"879259f2-7656-480a-bdb2-94d48148443e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[21521, 370, 233, 4, 34, "Subsection",ExpressionUUID->"72cb9da9-d861-4931-a3ab-66302b11f2d7"],
Cell[CellGroupData[{
Cell[21779, 378, 322, 4, 42, "Subsubsection",ExpressionUUID->"0b6d20cc-4936-4e26-a83e-03e3b772a459"],
Cell[22104, 384, 5970, 154, 535, "Input",ExpressionUUID->"d1095e33-3a62-4236-a71c-cd273ada1ac0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[28111, 543, 266, 4, 34, "Subsubsection",ExpressionUUID->"200b3a4a-a577-4c86-bee7-2edccbb6b300"],
Cell[28380, 549, 11175, 215, 1063, "Input",ExpressionUUID->"67210cac-2048-43dc-9a0e-3c36160f2148",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39604, 770, 279, 4, 50, "Subsection",ExpressionUUID->"e0c4af7e-9127-48cd-95b7-58f9e3fd9080"],
Cell[39886, 776, 5745, 112, 571, "Input",ExpressionUUID->"a957005f-7f39-4070-9f17-9d0681a6a928",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[45680, 894, 450, 7, 50, "Section",ExpressionUUID->"9fe9be40-4d96-49c8-b592-2dd3ed17322d"],
Cell[46133, 903, 20733, 400, 2103, "Input",ExpressionUUID->"e17e4c05-02ca-4e59-b6f3-9fbd557c7389",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[66903, 1308, 511, 8, 50, "Section",ExpressionUUID->"756c7ebd-20de-41e6-bd00-3fd8512ed73c"],
Cell[67417, 1318, 16847, 245, 186, "Input",ExpressionUUID->"a2684ece-35d2-40cb-9c20-e3102e233bf5",
 InitializationCell->True],
Cell[84267, 1565, 656, 24, 494, "Abstract",ExpressionUUID->"5e23ab78-813d-459b-b9fa-2e3aac9334e1"],
Cell[84926, 1591, 6342, 115, 384, "Input",ExpressionUUID->"2808617a-5996-41b7-b076-d38e30396e84",
 InitializationCell->True],
Cell[91271, 1708, 339, 10, 151, "Abstract",ExpressionUUID->"f1914dd5-9bcd-4006-8f04-fb791b8b2591"],
Cell[91613, 1720, 613, 13, 78, "Input",ExpressionUUID->"b34db014-9e9f-409f-9563-e0c7d69f6500",
 InitializationCell->True],
Cell[92229, 1735, 504, 8, 26, "Input",ExpressionUUID->"5453dc0a-c04d-4cab-a88e-4eaabc52f243"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92770, 1748, 622, 9, 63, "Section",ExpressionUUID->"be8a48c5-d4f9-4cb2-94df-dd6a1f3ee1ff"],
Cell[93395, 1759, 1972, 39, 189, "Input",ExpressionUUID->"94f50959-867a-475c-892a-c0a229a9f463"]
}, Open  ]]
}
]
*)

